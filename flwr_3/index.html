<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bad Flowers [Coconut Studios x <cnvs>]</title>
        
        <link rel="icon" href="img/SVG/cnvs-logomark-blk.svg" type="image/png">
        <link rel="stylesheet" href="style.css">
    
        <script src="https://cdn.jsdelivr.net/npm/simple-statistics@7.7.5/dist/simple-statistics.min.js"></script>
        <script defer src="./face-api.js-master/dist/face-api.min.js"></script>
        
        <script type="module" src="./firebase-config.js"></script>

        <script type="module" src="./script.js"></script>
        <script type="module" src="./flower.js"></script>
        <script type="module" src="./capture.js"></script>
        <script type="module" src="./send.js"></script>
        <script type="module" src="./auth.js"></script>
    </head>
    
    
<body>
    <section class="main-container">
        <div>
            <img class="logo-1" src="img/cnvs-logomark-wht.svg" alt="<cnvs> logo">
        </div>

        <!-- Login Modal (hidden by default) -->
        <div id="login-container" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <form id="login-form">
                    <input type="email" placeholder="Email Address" id="email" autocomplete="email">
                    <input type="password" placeholder="Password" id="password" autocomplete="current-password">
                    <button type="submit" id="login">Login</button>
                </form>
            </div>
        </div>
  
        <div class="canvas-container">

            <div id="video-container">
                <div id="faceExpression"></div>

                <div id="face-container">
                    <canvas id="face-detection"></canvas>
                    <canvas id="color-detection"></canvas>
                    <video id="video" width="640" height="480" autoplay muted></video>
                </div>

                <div id="colorDetection"></div>
            </div>
           
            <canvas id="myCanvas" width="400" height="400"></canvas>

            <!-- Capture Button -->
            <section class="button-container">
                <button id="counterButton"><div id="button-text">Capture Timer</div><div id="timer"></div></button>
            </section>

            <!-- Modal Popup -->
            <div id="imageModal" class="modal">
                <div class="modal-content">
                    <div id="captured-image">
                        <!-- Placeholder for captured image. Image will be added here dynamically -->
                        <img id="modalImage" src="" alt="Captured Flower Image">
                    </div>
                    <!-- Email form -->
                    <form id="emailForm">
                        <label for="emailAddress">Enter your email to receive the image:</label>
                        <input type="email" id="emailAddress" name="email" required placeholder="Your email address">
                        <!-- <button type="submit" id="submitEmail">Send Image</button> -->
                    </form>
                    <button type="button" id="printButton">Send Generated Flower</button>
                </div>
            </div>

        </div>

        <div>
            <img class="logo-2" src="img/coconut-studios_logo.jpg" alt="Coconut Studios Logo">
        </div>
    </section>

    <script>
        document.addEventListener('click', function() {
          console.log('Document was clicked');
        });
    </script>


    <script>
        document.querySelector('.logo-1').addEventListener('click', function() {
            var loginContainer = document.getElementById('login-container');
            loginContainer.style.display = loginContainer.style.display === "none" ? "block" : "none";
        });
    </script>

    <!-- <script type="module">
        import { saveImageAndEmail } from './send.js';
        
        const printButton = document.getElementById('printButton');
        
        printButton.addEventListener('click', async function handlePrintButtonClick(event) {
        // Prevent the default behavior of the button
        event.preventDefault();
    
        // Example of retrieving image data URL, replace with your actual code
        const imageDataUrl = document.getElementById('modalImage').src;
        const email = document.getElementById('emailAddress').value;
    
        if (printButton.textContent === 'Image Sent') {
            console.log('Image already sent.');
            return; // Prevent sending the image again
        }
    
        try {
            // Since saveImageAndEmail is an async function, we need to await it
            const success = await saveImageAndEmail(imageDataUrl, email);
            
            if (success) {
            printButton.textContent = 'Image Sent'; // Updates the button text
            } else {
            console.error('Failed to send the image.');
            // Handle the failure case, show a message to the user or log it
            }
        } catch (error) {
            console.error('An error occurred while sending the image:', error);
        }
        }, { once: true }); // Use the { once: true } option to listen only once
    </script> -->
    
    <script>
        const counterButton = document.getElementById('counterButton');
        const emailForm = document.getElementById('emailForm');
        const printButton = document.getElementById('printButton');
    
        counterButton.addEventListener('click', function() {
        setupCaptureTimer();
        // Reset the email form
        emailForm.reset();
    
        // Restore the default button text
        printButton.textContent = 'Send Generated Flower';

        });
    </script>
    
    <script>
        // Define this outside of any repeatable function to avoid multiple bindings
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = "none";
            }
        };
    </script>
  
</body>
</html>
